# Админ-панель ProjectVoice

## Обзор

Админ-панель предоставляет администраторам и модераторам инструменты для управления пользователями, серверами и мониторинга системы.

## Доступ

- **URL**: `/admin`
- **Требования**: Роль `admin` или `moderator`
- **Аутентификация**: JWT токен

## Функциональность

### 1. Дашборд

**Доступ**: Только администраторы

Отображает статистику системы:
- Общее количество пользователей
- Активные/заблокированные пользователи
- Распределение по ролям (админы, модераторы, пользователи)
- Количество серверов и каналов
- Статистика сообщений

### 2. Управление пользователями

**Доступ**: Модераторы и администраторы

#### Возможности:
- Просмотр списка всех пользователей
- Поиск по имени пользователя или email
- Фильтрация по роли и статусу
- Изменение роли пользователя
- Блокировка/разблокировка пользователей
- Удаление пользователей (только администраторы)

#### Роли пользователей:
- **user** - Обычный пользователь
- **moderator** - Модератор (может управлять пользователями)
- **admin** - Администратор (полный доступ)

### 3. Управление серверами

**Доступ**: Модераторы и администраторы

#### Возможности:
- Просмотр всех серверов
- Информация о каналах и участниках
- Удаление серверов (только администраторы)

### 4. Системные логи

**Доступ**: Только администраторы

Просмотр логов системы:
- Системные логи
- Логи ошибок
- Логи доступа

## API Endpoints

### Статистика
```
GET /api/admin/stats
```

### Пользователи
```
GET /api/admin/users?page=1&limit=20&search=test&role=user&status=active
GET /api/admin/users/:id
PUT /api/admin/users/:id
DELETE /api/admin/users/:id
```

### Серверы
```
GET /api/admin/servers?page=1&limit=20&search=test
GET /api/admin/servers/:id
DELETE /api/admin/servers/:id
```

### Логи
```
GET /api/admin/logs
```

## Безопасность

### Проверка прав
- Все запросы требуют JWT токен
- Проверка роли пользователя на каждом endpoint
- Защита от самоудаления/самоблокировки

### Middleware
- `authenticateToken` - проверка JWT токена
- `isAdmin` - проверка роли администратора
- `isModerator` - проверка роли модератора или администратора

## Первый администратор

При запуске миграции автоматически создается первый администратор:
- **Email**: admin@projectvoice.com
- **Пароль**: password
- **Роль**: admin

**Важно**: Измените пароль после первого входа!

## Настройка

### Переменные окружения
```env
NODE_ENV=development
JWT_SECRET=your_secret_key
```

### База данных
Миграция `20250707000000-add-admin-fields.js` добавляет:
- Поле `role` (ENUM: 'user', 'moderator', 'admin')
- Поле `isActive` (BOOLEAN)

## Использование

### Вход в админ-панель
1. Войдите в систему с правами администратора
2. Перейдите по адресу `/admin`
3. Используйте навигацию для переключения между разделами

### Управление пользователями
1. Перейдите в раздел "Пользователи"
2. Используйте фильтры для поиска нужных пользователей
3. Измените роль или статус пользователя
4. При необходимости удалите пользователя

### Мониторинг системы
1. Просматривайте статистику на дашборде
2. Проверяйте логи в разделе "Логи"
3. Отслеживайте активность серверов

## Ограничения

- Администраторы не могут удалить самих себя
- Администраторы не могут заблокировать самих себя
- Модераторы не могут изменять роли других модераторов или администраторов
- Модераторы не могут удалять пользователей

## Расширение

Для добавления новых функций:
1. Создайте новые маршруты в `backend/routes/admin.js`
2. Добавьте соответствующие методы в `frontend/src/services/adminService.ts`
3. Создайте компоненты в `frontend/src/pages/admin/`
4. Обновите навигацию в `AdminPanel.tsx` 